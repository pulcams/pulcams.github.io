<?xml-stylesheet type="text/xsl" href="xsltforms/xsltforms.xsl"?>
<?css-conversion no?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:sr="http://www.w3.org/2005/sparql-results#" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:p="http://www.w3.org/ns/xproc" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:cwb="http://libserv6.princeton.edu/cwb/" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:bf="http://bibframe.org/vocab/" cwb:firefox="yes">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <title>Cataloger's Workbench Editor</title>
    <xf:model>
      <xf:instance id="categories">
        <rdf:RDF>
          <bf:Work rdf:about="http://libserv6.princeton.edu/cwb/work/4003135">
            <bf:titleStatement>Perú, país solidario? / Felipe Portocarrero S., Armando Millán F.</bf:titleStatement>
            <bf:subject>
              <bf:Category rdf:about="http://libserv6.princeton.edu/cwb/category/88d25e67-ca62-41fa-9de2-500ab2ba102a#this">
                <bf:categoryValue>Agrarian and rural issues</bf:categoryValue>
                <dcterms:hasPart>
                  <bf:Topic rdf:about="http://libserv6.princeton.edu/cwb/topic/c18b074c-2bca-4aa1-9b96-7f863588d69f#this">
                    <bf:hasAuthority rdf:resource="http://id.loc.gov/authorities/subjects/sh85002317"/>
                  </bf:Topic>
                </dcterms:hasPart>
              </bf:Category>
            </bf:subject>
            <bf:subject>
              <bf:Category rdf:about="http://libserv6.princeton.edu/cwb/category/cf09dfba-ed41-4d82-9bdb-7ad7b105a6c3#this">
                <bf:categoryValue>Arts and culture</bf:categoryValue>
                <dcterms:hasPart>
                  <bf:Topic rdf:about="http://libserv6.princeton.edu/cwb/topic/4a4f0553-58e3-4836-bfcc-27566aa01c2e#this">
                    <bf:hasAuthority rdf:resource="http://id.loc.gov/authorities/subjects/sh85008276"/>
                  </bf:Topic>
                </dcterms:hasPart>
              </bf:Category>
            </bf:subject>
          </bf:Work>
          <bf:Instance rdf:about="http://libserv6.princeton.edu/cwb/instance/b1f11afe-da64-4aa8-b17c-3ced95b4d52b">
            <bf:identifier>
              <bf:Identifier rdf:about="http://libserv6.princeton.edu/cwb/identifier/a53a2e34-0fd6-436f-928e-bb53b19e022b">
                <bf:identifierScheme>item</bf:identifierScheme>
                <bf:identifierValue>3627985</bf:identifierValue>
              </bf:Identifier>
            </bf:identifier>
            <bf:identifier>
              <bf:Identifier rdf:about="http://libserv6.princeton.edu/cwb/identifier/c8d12f2e-edd2-4061-9c17-699827a8705e">
                <bf:identifierScheme/>
                <bf:identifierValue>1</bf:identifierValue>
              </bf:Identifier>
            </bf:identifier>
          </bf:Instance>
        </rdf:RDF>
      </xf:instance>
    </xf:model>
  </head>
  <body>
    <xf:repeat id="repeat-works-1" nodeset="instance('categories')/bf:Work">
      <xf:output value="bf:titleStatement"/>
      <xf:repeat id="repeat-categories-1" nodeset="bf:subject">
        <xf:group ref="bf:Category">
          <div class="select-vocab category">
            <xf:select1 appearance="minimal" ref="bf:categoryValue">
              <xf:label>Category name</xf:label>
              <xf:itemset nodeset="instance('bf-Category-categoryValue-categories')/cwb:category">
                <xf:label ref="@cwb:name"/>
                <xf:value ref="@cwb:name"/>
              </xf:itemset>
              <xf:action ev:event="xforms-value-changed">
                <xf:setvalue ref="../dcterms:hasPart/bf:Topic/bf:hasAuthority/@rdf:resource" value="''"/>
              </xf:action>
            </xf:select1>
          </div>
          <div class="select-vocab subject">
            <xf:select1 appearance="minimal" ref="dcterms:hasPart/bf:Topic/bf:hasAuthority/@rdf:resource[normalize-space(../../../../bf:categoryValue)]">
              <xf:label>Subtopic</xf:label>
              <xf:itemset nodeset="instance('bf-Topic-hasAuthority-subjects')/cwb:subject[@cwb:category = current()/../../../../bf:categoryValue]">
                <xf:label ref="@cwb:name"/>
                <xf:value ref="@cwb:uri"/>
              </xf:itemset>
            </xf:select1>
          </div>
        </xf:group>
        <span class="repeat-resource">
          <xf:trigger>
            <xf:label>+</xf:label>
            <xf:action ev:event="DOMActivate">
              <xf:insert nodeset="." origin="instance('categories-template')/bf:Work/bf:subject" position="after"/>
            </xf:action>
          </xf:trigger>
        </span>
        <span class="remove-resource">
          <xf:trigger ref=".[count(../bf:subject) &gt; 1]">
            <xf:label>-</xf:label>
            <xf:delete ev:event="DOMActivate" nodeset="."/>
          </xf:trigger>
        </span>
        <div class="save-resource">
          <xf:trigger>
            <xf:label>Save</xf:label>
            <xf:action ev:event="DOMActivate">
              <xf:setvalue ref="instance('categories')/bf:Instance/bf:identifier[2]/bf:Identifier/bf:identifierValue" value="instance('variables')/cwb:iter"/>
              <xf:send submission="write-file"/>
            </xf:action>
          </xf:trigger>
        </div>
      </xf:repeat>
    </xf:repeat>
  </body>
</html>